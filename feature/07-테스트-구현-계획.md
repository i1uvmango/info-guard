# 테스트 구현 계획

## 🎯 **테스트 구현 개요**
Info-Guard 프로젝트의 테스트는 단위 테스트, 통합 테스트, 시스템 테스트를 포함한 종합적인 품질 보증 시스템입니다. TDD(Test-Driven Development) 방식으로 개발하며, 자동화된 테스트를 통해 코드의 안정성과 신뢰성을 보장합니다.

## 🏗️ **테스트 아키텍처**

### 1. 테스트 피라미드
```
        ┌─────────────────┐
        │   E2E Tests     │ ← 사용자 시나리오 기반 (10%)
        └─────────────────┘
                │
        ┌─────────────────┐
        │ Integration     │ ← API 및 서비스 통합 (20%)
        │ Tests           │
        └─────────────────┘
                │
        ┌─────────────────┐
        │   Unit Tests    │ ← 개별 함수/클래스 (70%)
        └─────────────────┘
```

### 2. 테스트 디렉토리 구조
```
tests/
├── unit/                 # 단위 테스트
│   ├── python-server/   # Python 서버 테스트
│   ├── nodejs-server/   # Node.js 서버 테스트
│   └── chrome-extension/ # Chrome Extension 테스트
├── integration/          # 통합 테스트
├── e2e/                 # End-to-End 테스트
└── fixtures/            # 테스트 데이터
```

## 🧪 **핵심 테스트 구현**

### 1. Python AI 모델 테스트
```python
# 구현 위치: src/python-server/tests/test_ai/test_sentiment.py

import pytest
from app.ai.sentiment import SentimentAnalyzer

class TestSentimentAnalyzer:
    def test_analyze_positive_text(self):
        """긍정적 텍스트 분석 테스트"""
        analyzer = SentimentAnalyzer()
        result = analyzer.analyze("이 영상은 정말 유익하고 좋습니다!")
        
        assert result['sentiment_score'] > 0
        assert result['confidence'] > 0.5
    
    def test_analyze_negative_text(self):
        """부정적 텍스트 분석 테스트"""
        analyzer = SentimentAnalyzer()
        result = analyzer.analyze("이 영상은 정말 나쁘고 유해합니다.")
        
        assert result['sentiment_score'] < 0
        assert result['confidence'] > 0.5
```

### 2. Node.js 서버 테스트
```javascript
// 구현 위치: src/nodejs-server/tests/unit/analysis.test.js

describe('Analysis API Tests', () => {
    it('should create new analysis when video is not analyzed', async () => {
        const response = await request(app)
            .post('/api/v1/analysis/analyze')
            .send({
                video_id: 'test_video_123',
                title: 'Test Video',
                description: 'Test Description',
                user_id: 'test_user_123'
            });
        
        expect(response.status).toBe(200);
        expect(response.body.success).toBe(true);
    });
});
```

### 3. API 통합 테스트
```python
# 구현 위치: src/python-server/tests/integration/test_api_integration.py

class TestAPIIntegration:
    async def test_analysis_workflow(self, client):
        """전체 분석 워크플로우 테스트"""
        # 분석 요청
        response = await client.post("/api/v1/analysis/analyze", json={
            "video_id": "test_video_123",
            "title": "테스트 비디오",
            "description": "테스트 설명"
        })
        
        assert response.status_code == 200
        analysis_data = response.json()
        
        # 결과 조회
        analysis_id = analysis_data["analysis_id"]
        get_response = await client.get(f"/api/v1/analysis/{analysis_id}")
        assert get_response.status_code == 200
```

## 🌐 **E2E 테스트**

### 1. 사용자 시나리오 테스트
```python
# 구현 위치: src/python-server/tests/e2e/test_user_scenarios.py

class TestUserScenarios:
    async def test_youtube_video_analysis_flow(self, browser_context):
        """YouTube 비디오 분석 전체 플로우 테스트"""
        page = browser_context
        
        # YouTube 페이지 방문
        await page.goto("https://www.youtube.com/watch?v=dQw4w9WgXcQ")
        
        # Extension 활성화 확인
        extension_button = page.locator('[data-testid="infoguard-extension"]')
        assert await extension_button.is_visible()
        
        # 분석 시작 및 결과 확인
        await extension_button.click()
        result_display = page.locator('[data-testid="analysis-result"]')
        await result_display.wait_for(state="visible", timeout=30000)
```

### 2. 성능 테스트
```python
# 구현 위치: src/python-server/tests/e2e/test_performance.py

class TestPerformance:
    async def test_single_analysis_performance(self, analysis_service):
        """단일 분석 성능 테스트"""
        start_time = time.time()
        result = await analysis_service.analyze_text("테스트 텍스트" * 100)
        processing_time = time.time() - start_time
        
        assert processing_time < 5.0  # 5초 이내 완료
        assert result["status"] == "completed"
```

## 🚀 **테스트 자동화**

### 1. GitHub Actions 워크플로우
```yaml
# 구현 위치: .github/workflows/test.yml

name: Test Suite
on: [push, pull_request]

jobs:
  test-python:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Set up Python
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
    - name: Run tests
      run: |
        pip install -r requirements-dev.txt
        pytest tests/ -v --cov=app
```

### 2. 테스트 실행 스크립트
```bash
#!/bin/bash
# 구현 위치: scripts/run-tests.sh

echo "🧪 Info-Guard 테스트 실행 중..."

# Python 테스트
cd src/python-server
python -m pytest tests/ -v
cd ../..

# Node.js 테스트
cd src/nodejs-server
npm test
cd ../..

echo "✅ 모든 테스트 완료!"
```

## 🎯 **구현 완료 체크리스트**

- [ ] Python AI 모델 단위 테스트
- [ ] Node.js 서버 단위 테스트
- [ ] API 통합 테스트
- [ ] 기본 E2E 테스트
- [ ] GitHub Actions CI/CD
- [ ] 테스트 실행 스크립트

- [ ] Chrome Extension E2E 테스트
- [ ] 데이터베이스 통합 테스트

- [ ] 부하 테스트
- [ ] 보안 테스트
- [ ] 접근성 테스트